dnl Process this file with autoconf to produce a configure script.

AC_INIT(freedesktop.org.xml)
AM_INIT_AUTOMAKE(shared-mime-info, 0.8)

AM_CONFIG_HEADER(config.h)

dnl Check pkg-config is installed
if test -z "$PKG_CONFIG"; then
  PKG_CONFIG=pkg-config
fi
AC_SUBST(PKG_CONFIG)

AC_MSG_CHECKING(that pkg-config runs)
if "$PKG_CONFIG" --version > /dev/null 2>&1 ; then
  AC_MSG_RESULT(yes)
else
  AC_MSG_RESULT(no)
  AC_MSG_ERROR([*** $PKG_CONFIG missing ***

\'$PKG_CONFIG --version\' failed to run - make sure it is inside one of the
directories in your PATH environment variable!

pkg-config is available from this web page:

http://www.freedesktop.org/software/pkgconfig
])
fi

AC_DEFUN(REQUIRE, [
AC_MSG_CHECKING(that $1 (version >= $2) is installed)
if "$PKG_CONFIG" --atleast-version=$2 $1 ; then
  AC_MSG_RESULT(yes)
else
  AC_MSG_RESULT(no)
  if "$PKG_CONFIG" --exists $1 ; then
    AC_MSG_ERROR(Current version is only `"$PKG_CONFIG" "$1" --modversion`)
  else
    AC_MSG_ERROR(Package is not installed)
  fi
fi
])

dnl Check for libxml
REQUIRE(libxml-2.0, 2.0.0)

dnl Check for glib (if anyone from KDE has a problem with this, you can write
dnl the replacement code yourself ;-)
REQUIRE(glib-2.0, 2.0.0)

dnl Checks for programs.
AC_PROG_CC

dnl Use -Wall, etc if possible
[
if test "x$GCC" = "xyes"; then
  case " $CFLAGS " in
  *[\ \	]-Wall[\ \	]*) ;;
  *) CFLAGS="$CFLAGS -Wall -Wstrict-prototypes -Wmissing-prototypes -Wwrite-strings" ;;
  esac
fi
]

dnl Checks for typedefs, structures, and compiler characteristics.
AC_C_CONST

AC_SUBST([mimedir],         ['${datadir}/mime'])

AC_OUTPUT(Makefile)
